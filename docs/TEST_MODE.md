# テストモードガイド

## テストモードとは

テストモードは、ミニマムな条件で動作確認を行うためのモードです。本番環境よりも制限を厳しくして、短時間で動作確認ができるようにします。

## テストモードの有効化

`.env`ファイルに以下を追加：

```bash
TEST_MODE=true
```

## テストモードでの制限

| 項目 | 通常モード | テストモード |
|------|-----------|-------------|
| 1ソースあたりの最大記事数 | 50件 | **5件** |
| スクレイピング最大時間 | 5分 | **60秒** |
| ジョブ最大実行時間 | 10分 | **2分** |
| 処理するソース数 | 全ソース | **最大2ソース** |

## テストモードでの動作確認手順

### 1. テストモードを有効化

```bash
# .envファイルに追加
echo "TEST_MODE=true" >> .env
```

### 2. 開発サーバーを再起動

```bash
# 開発サーバーを停止して再起動
npm run dev
```

### 3. テスト用ソースを追加（オプション）

ブラウザで http://localhost:3000/sources にアクセスして、簡単なテスト用ソースを追加：

- **単一記事URL**: 1つの記事ページのURL
- **一覧ページURL**: 記事が少ないページ（5件以下が理想）

### 4. 手動ジョブを実行

```bash
curl -X POST http://localhost:3000/api/jobs/manual \
  -H "Authorization: Bearer dev-secret-123"
```

### 5. 結果を確認

- 記事一覧ページ（http://localhost:3000/articles）で収集された記事を確認
- エラーが発生していないか確認

## テストモードの利点

1. **短時間で動作確認**: 2分以内に結果が返る
2. **エラーの早期発見**: 制限が厳しいため、問題が早期に発見できる
3. **リソース節約**: API使用量やデータベース負荷を抑えられる
4. **開発効率向上**: 繰り返しテストが容易

## テストモードの注意事項

- テストモードでは、実際の運用に必要な記事数が収集されない可能性があります
- 本番環境では`TEST_MODE`を設定しないか、`false`に設定してください
- テストモードでも、エラーが発生した場合はログを確認してください
